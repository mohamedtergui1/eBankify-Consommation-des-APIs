<!-- bank-account.component.html -->
<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [closable]="true"
  [header]="idUpdateOrDelete ? 'Update Bank Account' : 'Create Bank Account'"
  [style]="{ width: '35rem', padding: '3rem' }"
>
  <form [formGroup]="accountForm" (ngSubmit)="onCreateAccount()">
    <span class="p-text-secondary block mb-8">
      Please fill in the details to create a new bank account.
    </span>

    <!-- Balance Field -->
    <div class="mb-6">
      <label for="balance" class="block mb-2 text-sm font-medium">Balance</label>
      <input
        type="number"
        id="balance"
        class="border text-sm rounded-lg block w-full p-2.5 dark:bg-gray-700"
        formControlName="balance"
        placeholder="Enter initial balance"
      />
      <div *ngIf="accountForm.get('balance')?.invalid && accountForm.get('balance')?.touched" class="mt-2 text-sm text-red-600">
        <span class="font-medium">Error: </span>
        <span *ngIf="accountForm.get('balance')?.errors?.['required']">Balance is required.</span>
        <span *ngIf="accountForm.get('balance')?.errors?.['min']">Balance cannot be negative.</span>
      </div>
    </div>

    <!-- Status Field -->
    <div class="mb-6">
      <label class="block mb-2 text-sm font-medium">Status</label>
      <p-select
        formControlName="status"
        [options]="statuses"
        optionLabel="name"
        optionValue="value"
        placeholder="Select status"
        [style]="{ width: '100%' }"
        styleClass="w-full"
      ></p-select>
      <div
        *ngIf="accountForm.get('status')?.invalid && (accountForm.get('status')?.touched || accountForm.get('status')?.dirty)"
        class="mt-2 text-sm text-red-600"
      >
        <span class="font-medium">Error: </span>Status is required.
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex justify-end gap-2">
      <button
        pButton
        [label]="idUpdateOrDelete ? 'Update' : 'Create'"
        type="submit"
        class="p-button-text"
        [disabled]="accountForm.invalid"
      ></button>
      <button
        pButton
        label="Cancel"
        type="button"
        (click)="visible = false"
        class="p-button-text"
      ></button>
    </div>
  </form>
</p-dialog>

<app-auth-layout>
  <div class="card">
    <div class="flex justify-end p-5">
      <p-button
        [label]="'Add ' + name"
        icon="pi pi-plus"
        severity="success"
        (click)="handleAdd()"
      ></p-button>
    </div>
    <p-table [value]="rows" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>account number</th>

          <th>Balance</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-row>
        <tr>
          <td>{{ row.id }}</td>
          <td>{{ row.balance }}</td>
          <td>{{ row.status }}</td>
          <td class="flex justify-end mr-2 gap-2">
            <p-button
              label="Edit"
              icon="pi pi-pencil"
              severity="info"
              (click)="handleEdit(row)"
            ></p-button>
            <p-button
              label="Delete"
              icon="pi pi-trash"
              severity="danger"
              (click)="handleDelete(row)"
            ></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div>Total Rows: {{ rows.length }}</div>
  </div>
</app-auth-layout>