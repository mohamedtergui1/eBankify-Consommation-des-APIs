<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [closable]="true"
  [header]="'Create User'"
  [style]="{ width: '35rem', padding: '3rem' }"
>
  <!-- user-form.component.html -->
  <form [formGroup]="userForm" (ngSubmit)="onCreateUser()">
    <span class="p-text-secondary block mb-8">
      Please fill in the details to create a new user.
    </span>
  
    <!-- Name Field -->
    <div class="mb-6">
      <label for="name" class="block mb-2 text-sm font-medium  ">Your name</label>
      <input
        type="text"
        id="name"
        class="bg-green-50 border   dark:text-green-400   text-sm rounded-lg focus:ring-green-500 focus: block w-full p-2.5 dark:bg-gray-700 dark:"
        formControlName="name"
        placeholder="Enter name"
      />
      <p *ngIf="userForm.get('name')?.invalid && userForm.get('name')?.touched" class="mt-2 text-sm text-red-600 dark:text-red-500">
        <span class="font-medium">Error:</span> Name is required.
      </p>
      
    </div>
  
    <!-- Email Field -->
    <div class="mb-6">
      <label for="email" class="block mb-2 text-sm font-medium ">Your email</label>
      <input
        type="email"
        id="email"
        class=" border    text-sm rounded-lg  dark:bg-gray-700  block w-full p-2.5  "
        formControlName="email"
        placeholder="Enter email"
      />
      <p *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="mt-2 text-sm text-red-600 ">
        <span class="font-medium">Error:</span>
        <span *ngIf="userForm.get('email')?.errors?.['required']">Email is required.</span>
        <span *ngIf="userForm.get('email')?.errors?.['email']">Invalid email format.</span>
      </p>
    </div>
  
    <!-- Age Field -->
    <div class="mb-6">
      <label for="age" class="block mb-2 text-sm font-medium  ">Age</label>
      <input
        type="number"
        id="age"
        class="bg-green-50 border   dark:text-green-400   text-sm rounded-lg focus:ring-green-500 focus: block w-full p-2.5 dark:bg-gray-700 dark:"
        formControlName="age"
        placeholder="Enter age"
      />
      <div *ngIf="userForm.get('age')?.invalid && userForm.get('age')?.touched" class="mt-2 text-sm text-red-600 dark:text-red-500">
        <span class="font-medium">Error: </span>
        <span *ngIf="userForm.get('age')?.errors?.['required']">Age is required.</span>
        <span *ngIf="userForm.get('age')?.errors?.['min']">Age must be at least 18.</span>
      </div>
    </div>
  
    <!-- Monthly Income Field -->
    <div class="mb-6">
      <label for="monthlyIncome" class="block mb-2 text-sm font-medium  ">Monthly Income</label>
      <input
        type="number"
        id="monthlyIncome"
        class="bg-green-50 border   dark:text-green-400   text-sm rounded-lg focus:ring-green-500 focus: block w-full p-2.5 dark:bg-gray-700 dark:"
        formControlName="monthlyIncome"
        placeholder="Enter monthly income"
      />
      <div *ngIf="userForm.get('monthlyIncome')?.invalid && userForm.get('monthlyIncome')?.touched" class="mt-2 text-sm text-red-600 dark:text-red-500">
        <span class="font-medium">Error: </span>
        <span *ngIf="userForm.get('monthlyIncome')?.errors?.['required']">Monthly Income is required.</span>
      </div>
    </div>
  
    <!-- Role Field -->
    <div class="mb-6">
      <label class="block mb-2 text-sm font-medium  ">Role</label>
      <p-select
        formControlName="role"
        [options]="roles"
        optionLabel="name"
        optionValue="value"
        placeholder="Select role"
        [style]="{ width: '100%' }"
        styleClass="w-full"
      ></p-select>
      <div
        *ngIf="userForm.get('role')?.invalid && (userForm.get('role')?.touched || userForm.get('role')?.dirty)"
        class="mt-2 text-sm text-red-600 dark:text-red-500"
      >
        <span class="font-medium">Error: </span>Role is required.
      </div>
    </div>
  
    <!-- Buttons -->
    <div class="flex justify-end gap-2">
      <button
        pButton
        [label]="idUpdateOrDelete ? 'Update' : 'Create'"
        type="submit"
        class="p-button-text"
        [disabled]="userForm.invalid"
      ></button>
      <button
        pButton
        label="Cancel"
        type="button"
        (click)="visible = false"
        class="p-button-text"
      ></button>
    </div>
  </form>

</p-dialog>

<app-auth-layout>
  <div class="card">
    <div class="flex justify-end p-5">
      <p-button
        [label]="'Add ' + name"
        icon="pi pi-plus"
        severity="success"
        (click)="handleAdd()"
      ></p-button>
    </div>
    <p-table [value]="rows" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template #header>
        <tr>
          <td>name</td>
          <td>email</td>
          <td>role</td>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template #body let-row>
        <tr>
          <td>
            {{ row.name }}
          </td>
          <td>
            {{ row.email }}
          </td>
          <td>
            {{ row.role }}
          </td>
          <td class="flex justify-end mr-2 gap-2">
            <p-button
              label="EDit"
              icon="pi pi-pencil"
              severity="info"
              (click)="handleEdit(row)"
            ></p-button>
            <p-button
              label="Delete"
              icon="pi pi-trash"
              severity="danger"
              (click)="handleDelete(row)"
            ></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div>Total Rows: {{ rows.length }}</div>
  </div>
  
</app-auth-layout>


